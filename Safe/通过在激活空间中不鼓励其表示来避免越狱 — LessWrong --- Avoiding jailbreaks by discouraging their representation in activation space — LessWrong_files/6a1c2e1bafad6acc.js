;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="9c829627-cf9b-2c2e-9b0e-ecfc23cc3ae3")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,284994,e=>{"use strict";var t=e.i(843476),i=e.i(271645),a=e.i(161517),r=e.i(552275),n=e.i(937636),l=e.i(182584),o=e.i(159211),s=e.i(791434),d=e.i(946271);e.i(813868);var c=e.i(122756),p=e.i(343794),g=e.i(144950),u=e.i(530841),h=e.i(644169),m=e.i(716970),y=e.i(864074),f=e.i(495314),v=e.i(782611),x=e.i(87828),w=e.i(239832),k=e.i(918488),b=e.i(110601),j=e.i(429329),P=e.i(79732),G=e.i(824083),R=e.i(206697),S=e.i(861766);let W={gridTemplateColumns:"45px minmax(200px, 1fr)"},B=(0,j.defineStyles)("PredictedTopPostsList",e=>({root:{maxWidth:765,margin:"0 auto",display:"grid"},prob:{marginRight:16,width:28,textAlign:"right",fontFamily:e.typography.fontFamily,color:e.palette.grey[500]},predictedPostList:{display:"grid",width:"100%",alignItems:"center",paddingRight:16,paddingLeft:16,[e.breakpoints.up("md")]:{paddingRight:0,paddingLeft:0},...W,...e.typography.body2},intro:{[e.breakpoints.up("md")]:{marginLeft:45,marginBottom:30},marginLeft:16,marginRight:16,marginBottom:45},loading:{gridColumn:2}})),C=(0,c.gql)("\n  query ReviewPredictionPosts($year: Int!, $limit: Int) {\n    reviewPredictionPosts(year: $year, limit: $limit) {\n      ...PostsListWithVotes\n      annualReviewMarketProbability\n      annualReviewMarketUrl\n    }\n  }\n"),I=()=>{let e=(0,P.useStyles)(B);return(0,t.jsxs)(x.default,{contentType:"post",className:e.intro,children:[(0,t.jsx)("p",{children:"The LessWrong Review highlights the posts most worth readers' time and attention. But its results take a while to appear. To bridge that gap, each popular post now has its own prediction market where users bet on whether it will rank among the year's top 50."}),(0,t.jsx)("p",{children:(0,t.jsx)(o.Link,{to:"https://manifold.markets/topic/lesswrong-annual-review",children:" See the markets here."})})]})},N=e=>{let{posts:a}=e,r=(0,P.useStyles)(B);return(0,t.jsx)(t.Fragment,{children:a.map((e,a)=>(0,t.jsxs)(i.default.Fragment,{children:[(0,t.jsx)(b.default,{title:"The Manifold prediction market predicts ".concat(Math.round(100*e.annualReviewMarketProbability),"% chance of being in the top 50 posts for this year."),children:e.annualReviewMarketUrl?(0,t.jsx)(o.Link,{to:e.annualReviewMarketUrl,children:(0,t.jsxs)("div",{className:r.prob,children:[Math.round(100*e.annualReviewMarketProbability),"%"]})}):(0,t.jsxs)("div",{className:r.prob,children:[Math.round(100*e.annualReviewMarketProbability),"%"]})}),(0,t.jsx)(R.default,{post:e,index:a,showKarma:!0,showIcons:!1,dense:!0,showCommentsIcon:!1,showPersonalIcon:!1})]},e._id))})};function T(e){var i;let{year:a}=e,r=(0,P.useStyles)(B),{data:n,loading:l,error:o}=(0,d.useQuery)(C,{variables:{year:a,limit:50}}),s=null!=(i=null==n?void 0:n.reviewPredictionPosts)?i:[];return o?(0,t.jsxs)("div",{className:r.root,children:[(0,t.jsx)(I,{}),(0,t.jsx)(S.default,{message:"Error loading predictions: ".concat(o.message)})]}):(0,t.jsxs)("div",{className:r.root,children:[(0,t.jsx)(I,{}),(0,t.jsx)("div",{className:r.predictedPostList,children:l?(0,t.jsx)("div",{className:r.loading,children:(0,t.jsx)(w.default,{})}):(0,t.jsx)(N,{posts:s})})]})}var _=e.i(995669),A=e.i(697724);let O={leftHeightPct:.2,leftWidthPct:.2,leftXPct:.2,leftYPct:.2,leftFlipped:!1,middleHeightPct:.2,middleWidthPct:.2,middleXPct:.2,middleYPct:.2,middleFlipped:!1,rightHeightPct:.2,rightWidthPct:.2,rightXPct:.2,rightYPct:.2,rightFlipped:!1},L={0:"left",1:"middle",2:"right"},Y=Object.fromEntries(Object.entries(L).map(e=>{let[t,i]=e;return[i,t]}));function E(e){return"gridPosition".concat(e)}let H=(0,j.defineStyles)("TopPostsPage",e=>({widerColumn:{marginLeft:"auto",marginRight:"auto",width:"min-content"},title:{fontSize:"4.0rem",fontWeight:500},description:{maxWidth:700,paddingLeft:17,[e.breakpoints.down(800)]:{paddingLeft:0}},gridContainer:{display:"flex",flexWrap:"wrap",rowGap:"20px",width:1200,marginTop:24,[e.breakpoints.down(1200)]:{width:800},[e.breakpoints.down(800)]:{width:"inherit",rowGap:0}},postsImageGrid:{position:"relative",display:"flex",transition:"height 0.5s ease-in-out",marginRight:"auto",marginLeft:"auto","&:hover $imageGridHeader":{background:e.palette.leastwrong.imageGridHeader},"&:hover $toggleIcon":{opacity:1},[e.breakpoints.down(800)]:{flexDirection:"column"},"&:hover $imageGridPostBody:not($imageGridPostRead)":{backdropFilter:"grayscale(0) brightness(0.6)","--top-posts-page-scrim-opacity":"0%"}},gridMobileCollapsed:{[e.breakpoints.down(800)]:{maxHeight:"159px !important",overflow:"hidden"}},expandedImageGrid:{"& $imageGridContainer":{transition:"width 0.5s ease-in-out",width:"calc(9 * 120px - 2px)",[e.breakpoints.down(1200)]:{width:"calc(6 * 120px - 2px)"},[e.breakpoints.down(800)]:{width:"calc(3 * 120px - 2px)",transition:"height 0.5s ease-in-out"}},"& $imageGrid":{left:"0 !important"},"& $imageGridPostOffscreen":{opacity:1,transitionDelay:"0s"},"& $toggleIcon":{transform:"rotate(45deg)"}},collapsedImageGrid:{"& $imageGridContainer":{transition:"width 0.5s ease-in-out, height 0.5s ease-in-out",width:0},"& $imageGridHeader":{width:38}},showAllImageGrid:{"& $imageGridContainer":{transition:"width 0.5s ease-in-out, height 0.5s ease-in-out"}},imageGridHeader:{writingMode:"vertical-rl",transform:"rotate(180deg)",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 0px 4px 3px",cursor:"pointer",transition:"background 0.2s ease-in, width 0.5s ease-in-out","&&&:hover":{background:e.palette.leastwrong.imageGridHeaderHighlighted},[e.breakpoints.up(800)]:{width:40,height:"inherit"},[e.breakpoints.down(800)]:{padding:0,writingMode:"inherit",transform:"none",width:"inherit",height:"40px"}},imageGridHeaderTitle:{margin:0,fontSize:32,transition:"opacity 0.5s ease-in 0.5s",...e.typography.headerStyle},toggleIcon:{fontSize:24,opacity:0,transform:"rotate(0deg)",transition:"transform 0.2s ease-in",transitionDelay:"0.5s",[e.breakpoints.down(800)]:{order:2,padding:0,margin:0,opacity:1}},imageGridContainer:{position:"relative",width:"calc(3 * 120px - 2px)",height:"inherit",overflow:"hidden",transition:"width 0.5s ease-in-out, height 0.5s ease-in-out",[e.breakpoints.down(800)]:{transition:"height 0.5s ease-in-out"}},imageGrid:{display:"grid",position:"absolute",top:0,overflow:"hidden",gridAutoFlow:"row",transition:"left 0.5s ease-in-out","&:hover $imageGridPostBackgroundContainer":{transitionDelay:"0.2s"}},...Object.fromEntries(Array.from({length:6},(t,i)=>[E(i),{left:"calc(-".concat(i%3*3," * 120px)"),[e.breakpoints.down(1200)]:{left:"calc(-".concat(i%2*3," * 120px)")},[e.breakpoints.down(800)]:{left:0}}])),imageGridBackgroundContainer:{position:"absolute",top:0,left:0,width:1080,zIndex:-1,transition:"opacity 0.2s ease-in",objectPosition:"right",background:e.palette.leastwrong.imageGridBackground,display:"flex",flexDirection:"column"},imageGridBackgroundContainerCategory:{zIndex:-2},imageGridBackground:{position:"relative",width:"100%"},imageGridBackgroundReflected:{transform:"scaleY(-1)"},showAllButton:{...e.typography.commentStyle,height:120,width:120,position:"absolute",top:0,background:e.palette.greyAlpha(.5),color:e.palette.text.invertedBackgroundText,display:"flex",alignItems:"center",justifyContent:"center",zIndex:3,cursor:"pointer",transition:"left 0.2s ease-in 0.5s",borderRight:"1px solid ".concat(e.palette.text.alwaysWhite),borderBottom:"1px solid ".concat(e.palette.text.alwaysWhite)},showAllButtonVisible:{left:0},showAllButtonHidden:{left:120,transition:"left 0.2s ease-in 0s"},imageGridPostJustExpanded:{pointerEvents:"none"},imageGridPost:{...e.typography.commentStyle,color:e.palette.text.alwaysWhite,display:"flex",textWrap:"balance",cursor:"pointer","&:hover":{opacity:1},"&:hover .hoverBackground":{opacity:1},"&&&:hover $imageGridPostBackgroundContainer":{display:"flex",opacity:1,transitionDelay:"0s",zIndex:2},"&&&:hover $imageGridPostBackgroundReflected":{zIndex:1,opacity:1},height:"inherit"},imageGridPostUnread:{"&":{backdropFilter:"grayscale(0.75) brightness(0.6)",background:"none"}},imageGridPostRead:{},imageGridPostHidden:{opacity:0,transitionDelay:"0.5s"},imageGridPostOffscreen:{opacity:0,transitionDelay:"0.5s"},imageGridPostBody:{borderRight:"1px solid ".concat(e.palette.text.alwaysWhite),borderBottom:"1px solid ".concat(e.palette.text.alwaysWhite),background:"linear-gradient(0deg, ".concat(e.palette.leastwrong.postBodyScrim,", transparent 60%)"),display:"flex",flexDirection:"column",justifyContent:"space-between",width:"100%",position:"relative",zIndex:4,transition:"backdrop-filter 0.5s ease-in-out, --top-posts-page-scrim-opacity 0.5s ease-in-out","&&&:hover":{background:e.palette.leastwrong.highlightedPost,backdropFilter:"none"},"&:hover:not(:has($imageGridPostHidden)) $imageGridPostAuthor":{opacity:1}},emptyGridCell:{borderRight:"1px solid ".concat(e.palette.text.alwaysWhite),borderBottom:"1px solid ".concat(e.palette.text.alwaysWhite),zIndex:3},imageGridPostBackgroundContainer:{position:"absolute",top:0,left:0,width:1080,opacity:0,zIndex:-1,transition:"opacity 0.2s ease-in",transitionDelay:"0.2s",objectPosition:"right",background:e.palette.leastwrong.imageGridBackground,display:"flex",flexDirection:"column"},imageGridPostBackgroundContainerHidden:{"&&&&&&":{display:"none"}},imageGridPostBackground:{position:"relative",width:"100%"},imageGridPostBackgroundReflected:{transform:"scaleY(-1)"},imageGridPostBackgroundCompleteHovered:{},imageGridPostAuthor:{opacity:0,textAlign:"right",paddingTop:2,fontWeight:600,paddingRight:6,transition:"opacity 0.2s ease-in",paddingLeft:12},imageGridPostTitle:{padding:4,paddingTop:0,transition:"opacity 0.2s ease-in",textShadow:"0px 0px 3px ".concat(e.palette.text.alwaysBlack,", 0 0 5px ").concat(e.palette.text.alwaysBlack,", 0 0 8px ").concat(e.palette.text.alwaysBlack),textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:6,WebkitBoxOrient:"vertical",overflow:"hidden"},expandIcon:{},"@global":{"@property --top-posts-page-scrim-opacity":{syntax:'"<percentage>"',inherits:!1,initialValue:"36%"}},postsByYearSectionCentered:{marginTop:60,width:"calc(100vw - 16px)",display:"flex",flexDirection:"column",alignItems:"center","& h1":{...e.typography.display3,marginTop:0,...e.typography.headerStyle}},categoryTitle:{textTransform:"capitalize"},year:{...e.typography.display1,...e.typography.headerStyle,margin:12,color:e.palette.grey[600],[e.breakpoints.down("sm")]:{marginLeft:6,marginRight:6}},yearAll:{fontVariant:"all-small-caps",fontSize:30,position:"relative",top:-4},yearIsSelected:{color:e.palette.grey[900],fontWeight:600},category:{...e.typography.display1,fontSize:"1.6rem",margin:12,...e.typography.headerStyle,fontVariantCaps:"all-small-caps",color:e.palette.grey[600],whiteSpace:"nowrap",display:"inline-block",[e.breakpoints.down("sm")]:{margin:8,marginBottom:2,marginTop:4}},categoryIsSelected:{color:e.palette.grey[900],fontWeight:600},postsByYearCategory:{display:"flex",marginBottom:12},yearCategorySectionTitle:{...e.typography.display2,...e.typography.headerStyle,marginBottom:12},yearSelector:{textWrap:"balance",marginBottom:"12px",display:"flex",justifyContent:"center",flexWrap:"wrap"},categorySelector:{textWrap:"balance",marginBottom:24,display:"flex",justifyContent:"center",flexWrap:"wrap"},disabledCategory:{opacity:.5,cursor:"default"},spotlightItem:{marginBottom:20,display:"flex",alignItems:"center","& .SpotlightItem-root":{[e.breakpoints.down("sm")]:{width:"calc(100vw - 16px)"},[e.breakpoints.up("xs")]:{marginBottom:-8}}},spotlightRanking:{marginRight:16,width:28,textAlign:"right",...e.typography.body2,...e.typography.headerStyle,color:e.palette.grey[500],[e.breakpoints.down("sm")]:{display:"none"}},spotlightIsNotRead:{filter:"saturate(0) opacity(0.8)","&:hover":{filter:"saturate(1) opacity(1)"}},spotlightCheckmarkRow:{marginTop:8,marginBottom:52,textWrap:"balance",textAlign:"center",maxWidth:m.SECTION_WIDTH},spotlightCheckmark:{display:"inline-block",width:14,height:14,borderRadius:3,border:"solid 1px ".concat(e.palette.grey[400]),backgroundColor:e.palette.grey[100],margin:2},spotlightCheckmarkIsRead:{backgroundColor:e.palette.lwTertiary.main,borderColor:e.palette.grey[700],backgroundOpacity:.2,opacity:.7},loading:{height:30},tallPlaceholder:{height:"100vh"},predictedYear:{color:e.palette.review.winner,opacity:.55}}));function M(e){var l,s;let{reviewWinnersWithPosts:g}=e,u=r.reviewWinnerSectionsInfo.get();r.reviewWinnerYearGroupsInfo.get();let v=(0,P.useStyles)(H),x=(0,n.useLocation)(),j=(0,n.useNavigate)(),{query:{year:G,category:R}}=x,S=[...f.reviewWinnerCategories],[W,B]=(0,i.useState)(function(e){if(!e)return f.BEST_OF_LESSWRONG_PUBLISH_YEAR;if("all"===e)return"all";let t=parseInt(e);return f.publishedReviewYears.has(t)||f.predictedReviewYears.has(t)?t:f.BEST_OF_LESSWRONG_PUBLISH_YEAR}(G)),C=R&&f.reviewWinnerCategories.has(R)?R:"all",[I,N]=(0,i.useState)(C),O=[];O="all"===W&&"all"===I?g:"all"===W?g.filter(e=>{var t;return(null==(t=e.reviewWinner)?void 0:t.category)===I}):"all"===I?g.filter(e=>{var t;return(null==(t=e.reviewWinner)?void 0:t.reviewYear)===W}):g.filter(e=>{var t,i;return(null==(t=e.reviewWinner)?void 0:t.reviewYear)===W&&(null==(i=e.reviewWinner)?void 0:i.category)===I});let L=(0,d.useQuery)((0,c.gql)("\n    query GetReviewWinnerSpotlights($selector: PostSelector, $limit: Int, $enableTotal: Boolean) {\n      posts(selector: $selector, limit: $limit, enableTotal: $enableTotal) {\n        results {\n          ...PostsBase\n          reviewWinner {\n            ...ReviewWinnerTopPostsPage\n          }\n          spotlight {\n            ...SpotlightDisplay\n          }\n        }\n      }\n    }\n  "),{variables:{selector:{default:{postIds:O.map(e=>e._id)}}}}),Y=null==L||null==(s=L.data)||null==(l=s.posts)?void 0:l.results,E=Y&&Y.filter(e=>!!e.spotlight).sort((e,t)=>{var i,a,r,n,l,o,s,d,c,p,u,h,m,y,f,v,x,w;let k=g.find(t=>t._id===(null==e?void 0:e._id)),b=g.find(e=>e._id===(null==t?void 0:t._id));return(null==k||null==(i=k.reviewWinner)?void 0:i.reviewRanking)!==(null==b||null==(a=b.reviewWinner)?void 0:a.reviewRanking)?(null!=(c=null==k||null==(s=k.reviewWinner)?void 0:s.reviewRanking)?c:0)-(null!=(p=null==b||null==(d=b.reviewWinner)?void 0:d.reviewRanking)?p:0):(null==k||null==(r=k.reviewWinner)?void 0:r.reviewYear)!==(null==b||null==(n=b.reviewWinner)?void 0:n.reviewYear)?(null!=(m=null==k||null==(u=k.reviewWinner)?void 0:u.reviewYear)?m:0)-(null!=(y=null==b||null==(h=b.reviewWinner)?void 0:h.reviewYear)?y:0):(null==k||null==(l=k.reviewWinner)?void 0:l.category)!==(null==b||null==(o=b.reviewWinner)?void 0:o.category)?(null!=(x=null==k||null==(f=k.reviewWinner)?void 0:f.category)?x:"").localeCompare(null!=(w=null==b||null==(v=b.reviewWinner)?void 0:v.category)?w:""):0}),M=e=>"".concat(x.pathname,"?").concat(h.default.stringify({year:e,category:I})),F=e=>"".concat(x.pathname,"?").concat(h.default.stringify({year:W,category:e})),$=(e,t)=>{if(e.shiftKey||e.altKey||e.ctrlKey||e.metaKey)return;let i=h.default.stringify({year:t,category:I});j({...x,search:i},{replace:!0,skipRouter:!0}),B(t),e.preventDefault()},z=(e,t)=>{if(e.shiftKey||e.altKey||e.ctrlKey||e.metaKey)return;let i=h.default.stringify({year:W,category:t});j({...x,search:i},{replace:!0,skipRouter:!0}),N(t),e.preventDefault()},D=(0,_.useItemsRead)(),K=E&&E.some(e=>e._id in D.postsRead?D.postsRead[e._id]:e.isRead);return(0,t.jsx)(a.AnalyticsContext,{pageSectionContext:"topPostsPageSpotlightSection",children:(0,t.jsxs)("div",{className:v.postsByYearSectionCentered,id:"year-category-section",children:[(0,t.jsxs)("div",{className:v.yearSelector,children:[[...f.publishedReviewYears].map(e=>{let i=g.filter(t=>{var i;return(null==(i=t.reviewWinner)?void 0:i.reviewYear)===e}).length;return(0,t.jsx)(b.default,{title:"".concat(i," posts"),placement:"top",children:(0,t.jsx)("a",{onClick:t=>$(t,e),href:M(e),className:(0,p.default)(v.year,e===W&&v.yearIsSelected),children:e})},e)}),[...f.predictedReviewYears].map(e=>(0,t.jsx)(b.default,{title:"Predictions for ".concat(e),placement:"top",children:(0,t.jsx)("a",{onClick:t=>$(t,e),href:M(e),className:(0,p.default)(v.year,e===W&&v.yearIsSelected,v.predictedYear),children:e})},e)),(0,t.jsx)(b.default,{title:"".concat(g.length," posts"),inlineBlock:!1,children:(0,t.jsx)("a",{onClick:e=>$(e,"all"),href:M("all"),className:(0,p.default)(v.year,"all"===W&&v.yearIsSelected,v.yearAll),children:"All"})},"all")]}),"number"==typeof W&&f.predictedReviewYears.has(W)?(0,t.jsx)(A.default,{}):(0,t.jsxs)("div",{className:v.categorySelector,children:[S.map(e=>{let i="all"===W?g.filter(t=>{var i;return(null==(i=t.reviewWinner)?void 0:i.category)===e}).length:g.filter(t=>{var i,a;return(null==(i=t.reviewWinner)?void 0:i.reviewYear)===W&&(null==(a=t.reviewWinner)?void 0:a.category)===e}).length;return(0,t.jsx)(b.default,{title:"".concat(i," posts"),inlineBlock:!1,children:(0,t.jsx)("a",{onClick:t=>z(t,e),href:F(e),className:(0,p.default)(v.category,!i&&v.disabledCategory,e===I&&v.categoryIsSelected),children:u[e].title})},e)}),(0,t.jsx)(b.default,{title:"".concat(g.filter(e=>{var t;return"all"===W||(null==(t=e.reviewWinner)?void 0:t.reviewYear)===W}).length," posts"),inlineBlock:!1,children:(0,t.jsx)("a",{onClick:e=>z(e,"all"),href:F("all"),className:(0,p.default)(v.category,"all"===I&&v.categoryIsSelected),children:"All"})},"all")]}),E&&E.length>0&&(0,t.jsx)("div",{className:v.spotlightCheckmarkRow,children:E&&E.map(e=>{var i,a,r,n,l;let s=e._id in D.postsRead?D.postsRead[e._id]:e.isRead,d=e.spotlight,c="all"!==I&&"all"!==W||"all"===W?null==e||null==(i=e.reviewWinner)?void 0:i.reviewYear:"",g="all"!==W&&"all"!==I||"all"===I?null==e||null==(a=e.reviewWinner)?void 0:a.category:"",u=null==(l=e.spotlight)||null==(n=l.post)||null==(r=n.user)?void 0:r.displayName,h=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:e.title}),(0,t.jsx)("div",{children:(0,t.jsxs)("em",{children:["by ",u]})}),(c||g)&&(0,t.jsx)("div",{children:(0,t.jsxs)("em",{children:[c," ",(0,t.jsx)("span",{style:{textTransform:"capitalize"},children:g})]})})]});return(0,t.jsx)(b.default,{title:h,children:(0,t.jsx)(o.Link,{to:(0,y.getSpotlightUrl)(d),className:(0,p.default)(v.spotlightCheckmark,s&&v.spotlightCheckmarkIsRead)},e._id)},e._id)})}),"number"==typeof W&&f.predictedReviewYears.has(W)?(0,t.jsx)("div",{style:{maxWidth:m.SECTION_WIDTH},children:(0,t.jsx)(T,{year:W})}):(0,t.jsxs)("div",{style:{maxWidth:m.SECTION_WIDTH},children:[!E&&(0,t.jsx)("div",{className:v.tallPlaceholder,children:(0,t.jsx)(w.default,{})}),E&&E.map(e=>{var i,a,r;let n=e._id in D.postsRead?D.postsRead[e._id]:e.isRead,l=(null!=(r=null==(i=e.reviewWinner)?void 0:i.reviewRanking)?r:0)+1;return e.spotlight&&(0,t.jsxs)("div",{className:(0,p.default)(v.spotlightItem,K&&!n&&v.spotlightIsNotRead),children:[(0,t.jsx)(b.default,{title:"Ranked #".concat(l," in ").concat(null==(a=e.reviewWinner)?void 0:a.reviewYear),children:(0,t.jsxs)("div",{className:v.spotlightRanking,children:["#",l]})}),(0,t.jsx)(k.SpotlightItem,{spotlight:e.spotlight,showSubtitle:!1})]},e._id)})]})]})})}let F=e=>{let{postsInGrid:i,...a}=e;return(0,t.jsx)(t.Fragment,{children:i.map((e,i)=>e.map((e,r)=>{var n;return(0,t.jsx)($,{post:e,rowIdx:i,columnIdx:r,...a},null!=(n=null==e?void 0:e._id)?n:"empty-".concat(i,"-").concat(r))}))})},$=e=>{var i,a;let{post:r,rowIdx:n,columnIdx:l,viewportHeight:o,postGridColumns:s,postGridRows:d,id:c,handleToggleFullyOpen:g,isExpanded:u,isShowingAll:h,leftBookOffset:m,coverLoaded:y,expandedNotYetMoved:f,dpr:v}=e,x=(0,P.useStyles)(H),w=l-3*m,k=(0,t.jsx)("div",{className:x.emptyGridCell},"empty-".concat(n,"-").concat(l)),b=null!=(a=null==r||null==(i=r.reviewWinner)?void 0:i.reviewWinnerArt)?a:void 0,j=b?function(e){let{reviewWinnerArt:t,leftBookOffset:i,dpr:a}=e,{splashArtImageUrl:r,activeSplashArtCoordinates:n}=t;return z(r,null!=n?n:O,i,a).replace("f_auto,q_auto","f_auto,q_auto:eco")}({reviewWinnerArt:b,leftBookOffset:m,dpr:v}):"",G=!(n<o&&w<3&&w>=0||-1===w||u||h)||!y||f,R=(0,p.default)({[x.imageGridPostBackgroundContainerHidden]:G});return r?(0,t.jsx)(K,{post:r,imgSrc:j,imageGridId:c,imageClass:R,isShowAll:n===o-1&&l===s-1&&u,showAllVisible:u&&!h&&d>4,handleToggleFullyOpen:g},r._id):k},z=(e,t,i,a)=>{let r=L[i];r||(console.error("Invalid leftBookOffset ".concat(i," used to derive coordinate position")),r="left");let{["".concat(r,"XPct")]:n,["".concat(r,"YPct")]:l,["".concat(r,"WidthPct")]:o,["".concat(r,"Flipped")]:s}=t,d=Math.min(1,Math.max(0,n-o*i)),c=Math.min(1,Math.max(0,3*o)),p="c_crop,w_".concat(c,",x_").concat(d,",y_").concat(l,",h_1/").concat(2===a?"dpr_2.0,":"","w_1080");return e.replace("upload/","upload/".concat(p,"/")).replace("upload/","upload/".concat(s?"a_hflip/":""))},D=e=>{let a,r,{posts:n,img:l,coords:o,header:s,id:d,horizontalBookGridCount:c,gridPosition:u,expansionState:h,handleToggleExpand:m,handleToggleFullyOpen:y,hiddenState:f,expandedNotYetMoved:v}=e,x=(0,P.useStyles)(H),w=(0,i.useRef)(null),[k,b]=(0,i.useState)(!1),[j,G]=(0,i.useState)(1),R=u%c,S=3*c,W=Math.max(Math.ceil(n.length/S),4),B=function(e){let{posts:t,viewportWidth:i,viewportHeight:a,postGridColumns:r,postGridRows:n,leftBookOffset:l}=e,o=(0,g.default)(n).map(e=>(0,g.default)(r).map(e=>null)),s=0,d=3*l;for(let e=0;e<Math.min(a,n);e++)for(let a=d;a<d+i;a++)o[e][a]=t[s++];for(let e=0;e<n;e++)for(let i=0;i<r;i++)if(null===o[e][i]){var c;o[e][i]=null!=(c=t[s++])?c:null}return o}({posts:n,viewportWidth:3,viewportHeight:4,postGridColumns:S,postGridRows:W,leftBookOffset:R}),C="expanded"===h,I="collapsed"===h,N="full"===f,T=function(e){let{postGridRows:t,postGridColumns:i}=e;return{gridTemplateRows:"repeat(".concat(t,", 120px)"),gridTemplateColumns:"repeat(".concat(i,", 120px)")}}({postGridRows:W,postGridColumns:S}),_=(r=40*!!(a=1===c),N?120*W+r-1:a?C?480+r-1:120+r-1:479),A=1===c?_-40:_,L=E(u),Y=(0,t.jsx)(F,{postsInGrid:B,viewportHeight:4,postGridColumns:S,postGridRows:W,id:d,gridContainerHeight:A,handleToggleFullyOpen:y,isExpanded:C,isShowingAll:N,leftBookOffset:R,coverLoaded:k,expandedNotYetMoved:v,dpr:j}),M=(0,p.default)(x.postsImageGrid,{[x.expandedImageGrid]:C,[x.collapsedImageGrid]:I,[x.showAllImageGrid]:N,[x.gridMobileCollapsed]:!C||I}),$=(0,p.default)(x.imageGrid,x[L]),D=z(l,null!=o?o:O,R,j);return(0,i.useEffect)(()=>{var e;(null==(e=w.current)?void 0:e.complete)&&b(!0)},[]),(0,i.useEffect)(()=>{G(window.devicePixelRatio>=2?2:1)},[]),(0,t.jsxs)("div",{className:M,id:"PostsImageGrid-".concat(d),style:{height:_},children:[(0,t.jsxs)("div",{className:x.imageGridHeader,onClick:()=>m(d),children:[(0,t.jsx)("span",{className:x.toggleIcon,children:(0,t.jsx)("span",{className:x.expandIcon,children:"+"})}),(0,t.jsx)("h2",{className:x.imageGridHeaderTitle,children:s})]}),(0,t.jsx)("div",{className:x.imageGridContainer,style:{height:A},children:(0,t.jsxs)("div",{className:$,style:T,children:[(0,t.jsxs)("div",{className:(0,p.default)(x.imageGridBackgroundContainer,x.imageGridBackgroundContainerCategory),children:[(0,t.jsx)("img",{src:D,ref:w,onLoad:()=>b(!0),className:x.imageGridBackground}),(0,t.jsx)("img",{src:D,className:(0,p.default)([x.imageGridBackground,x.imageGridBackgroundReflected])}),(0,t.jsx)("img",{src:D,className:x.imageGridBackground}),(0,t.jsx)("img",{src:D,className:(0,p.default)([x.imageGridBackground,x.imageGridBackgroundReflected])})]}),Y]})})]})},K=e=>{var a;let{post:r,imgSrc:s,imageGridId:d,handleToggleFullyOpen:c,imageClass:g,isShowAll:h=!1,showAllVisible:m=!1}=e,y=(0,P.useStyles)(H),f=(0,u.useCurrentUser)(),v=(0,p.default)(y.imageGridPostTitle,{[y.imageGridPostHidden]:h&&m}),x=(0,p.default)(y.imageGridPostAuthor,{[y.imageGridPostHidden]:h&&m}),w=(0,p.default)(y.showAllButton,{[y.showAllButtonVisible]:m,[y.showAllButtonHidden]:!m}),[k,b]=(0,i.useState)(!1),{location:j}=(0,n.useLocation)(),G=(0,i.useRef)(null),R=(0,_.useItemsRead)(),S=r._id in R.postsRead?R.postsRead[r._id]:r.isRead;return(0,t.jsxs)(o.Link,{className:y.imageGridPost,to:h&&m?j.pathname+j.search:(0,l.postGetPageUrl)(r),children:[(0,t.jsxs)("div",{className:(0,p.default)(y.imageGridPostBody,{[y.imageGridPostUnread]:f&&!S,[y.imageGridPostRead]:f&&S}),onMouseOver:()=>{var e;b(!!(null==(e=G.current)?void 0:e.complete))},onMouseLeave:()=>b(!1),children:[(0,t.jsx)("div",{className:x,children:null==r||null==(a=r.user)?void 0:a.displayName}),(0,t.jsx)("div",{className:v,children:r.title}),h&&(0,t.jsx)("div",{className:w,onClick:e=>{e.preventDefault(),e.stopPropagation(),c(d)},children:"Show All"},"show-all")]}),(0,t.jsxs)("div",{className:(0,p.default)([y.imageGridPostBackgroundContainer,{[y.imageGridPostBackgroundContainerHidden]:h&&m}]),children:[(0,t.jsx)("img",{ref:G,loading:"lazy",className:(0,p.default)([y.imageGridPostBackground,g,{[y.imageGridPostBackgroundCompleteHovered]:k&&!(h&&m)}]),src:s}),(0,t.jsx)("img",{loading:"lazy",className:(0,p.default)([y.imageGridPostBackgroundReflected,y.imageGridPostBackground,g]),src:s}),(0,t.jsx)("img",{loading:"lazy",className:(0,p.default)([y.imageGridPostBackground,g]),src:s}),(0,t.jsx)("img",{loading:"lazy",className:(0,p.default)([y.imageGridPostBackgroundReflected,y.imageGridPostBackground,g]),src:s})]})]},r._id)};e.s(["COORDINATE_POSITIONS_TO_BOOK_OFFSETS",0,Y,"default",0,()=>{var n;let l=(0,P.useStyles)(H),p=Math.min(Math.max(Math.floor(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3,[a,r]=(0,i.useState)(t);return(0,i.useEffect)(()=>{var t;function i(){var t,i;r((null==(i=e.g)||null==(t=i.visualViewport)?void 0:t.width)||2e3)}return null==(t=e.g)||t.addEventListener("resize",i),i(),()=>e.g.removeEventListener("resize",i)},[]),a}(2e3)/400),1),3),[g,u]=(0,i.useState)({}),[h,m]=(0,i.useState)([]),[y,f]=(0,i.useState)(!1),k=e=>{let t,i,a,r,n,l=(t=document.querySelectorAll('[id^="PostsImageGrid-"]'),i=g[e]||"default",r=null==(a=document.getElementById("PostsImageGrid-".concat(e)))?void 0:a.getBoundingClientRect().top,n=Array.from(t).filter(e=>e.getBoundingClientRect().top===r&&a),{...g,...Object.fromEntries(n.map(e=>[e.id.replace("PostsImageGrid-",""),"expanded"===i?"default":"collapsed"])),[e]:"expanded"===i?"default":"expanded"});if(0!==h.length){let t=Object.keys(l).filter(e=>"collapsed"===l[e]);m([...h].filter(i=>!t.includes(i)&&e!==i))}u(l),f(!0)},b=e=>{h.includes(e)?m([...h].filter(t=>t!==e)):m([...h,e])},{data:j,loading:R}=(0,d.useQuery)((0,c.gql)("\n    query GetAllReviewWinners {\n      GetAllReviewWinners {\n        ...PostsTopItemInfo\n      }\n    }\n  ")),S=[...null!=(n=null==j?void 0:j.GetAllReviewWinners)?n:[]],W=[...S].sort((e,t)=>{var i,a,r,n,l,o,s,d;let c=(null!=(l=null==(i=e.reviewWinner)?void 0:i.curatedOrder)?l:Number.MAX_SAFE_INTEGER)-(null!=(o=null==(a=t.reviewWinner)?void 0:a.curatedOrder)?o:Number.MAX_SAFE_INTEGER);return 0!==c?c:(null!=(s=null==(r=e.reviewWinner)?void 0:r.reviewRanking)?s:0)-(null!=(d=null==(n=t.reviewWinner)?void 0:n.reviewRanking)?d:0)}),B=r.reviewWinnerSectionsInfo.get(),C=r.reviewWinnerYearGroupsInfo.get();if(!B)throw Error("Failed to load reviewWinnerSectionsInfo (image data) from public settings");if(!C)throw Error("Failed to load reviewWinnerYearGroupsInfo (image data) from public settings");let I=Object.entries(B).sort((e,t)=>{let[,i]=e,[,a]=t;return i.order-a.order}).map((e,i)=>{var a,r,n;let[l,{title:o,imgUrl:s,coords:d}]=e;return a=W.filter(e=>{var t;return(null==(t=e.reviewWinner)?void 0:t.category)===l}),r=null!=d?d:O,n=null!=o?o:l,(0,t.jsx)(D,{id:l,posts:a,img:s,coords:r,header:n,horizontalBookGridCount:p,gridPosition:i,expansionState:g[l],handleToggleExpand:k,handleToggleFullyOpen:b,hiddenState:function(e,t){if(0!==t.length)return t.includes(e)?"full":"hidden"}(l,h),expandedNotYetMoved:y},l)});return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(a.AnalyticsContext,{pageContext:"topPostsPage",children:[(0,t.jsxs)("div",{className:l.widerColumn,children:[(0,t.jsxs)("div",{className:l.description,children:[(0,t.jsx)(v.default,{title:(0,s.preferredHeadingCase)("The Best of LessWrong"),titleClassName:l.title}),(0,t.jsxs)(x.default,{contentType:"post",children:["When posts turn more than a year old, the LessWrong community reviews and votes on how well they have stood the test of time. These are the posts that have ranked the highest for all years since 2018 (when our annual tradition of choosing the least wrong of LessWrong began).",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),"For the years 2018, 2019 and 2020 we also published physical books with the results of our annual vote, which you can buy and learn more about ",(0,t.jsx)(o.Link,{to:"/books",children:"here"}),"."]})]}),(0,t.jsx)("div",{className:l.gridContainer,onMouseMove:()=>y&&f(!1),children:I})]}),(0,t.jsx)(G.SuspenseWrapper,{name:"TopSpotlightsSection",fallback:(0,t.jsx)("div",{className:l.tallPlaceholder}),children:(0,t.jsx)(M,{reviewWinnersWithPosts:S})}),R&&(0,t.jsx)("div",{className:l.tallPlaceholder,children:(0,t.jsx)(w.default,{})})]})})}],284994)}]);

//# debugId=9c829627-cf9b-2c2e-9b0e-ecfc23cc3ae3
//# sourceMappingURL=4ef6d126663d95bc.js.map
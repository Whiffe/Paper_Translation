;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="5302ce64-4a41-90f5-720e-307aad4169d9")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,918488,26829,e=>{"use strict";e.s(["SpotlightItem",()=>ei,"descriptionStyles",()=>X,"getSpotlightDisplayTitle",()=>et],918488);var t=e.i(843476);e.i(793794);var i=e.i(527633),a=e.i(758495),s=e.i(271645);let n=(0,e.i(339213).default)((0,t.jsxs)(s.default.Fragment,{children:[(0,t.jsx)("path",{fill:"none",d:"M0 0h24v24H0z"}),(0,t.jsx)("path",{d:"M5 4v2h14V4H5zm0 10h4v6h6v-6h4l-7-7-7 7z"})]}),"Publish");var o=e.i(802056),l=e.i(636867),r=e.i(343794),d=e.i(820010),u=e.i(159211),c=e.i(673991),p=e.i(253592),m=e.i(530841),h=e.i(791434),g=e.i(716970),b=e.i(864074),f=e.i(514089);e.i(813868);var x=e.i(122756),y=e.i(161517),v=e.i(478386),j=e.i(758623),S=e.i(919202),I=e.i(690118),k=e.i(425415);e.s(["default",()=>w],26829);let w=(0,e.i(538794).registerComponent)("SpotlightEditorStyles",e=>{let{classes:i,children:a}=e;return(0,t.jsx)("div",{className:i.root,children:a})},{styles:e=>({root:{[e.breakpoints.up("md")]:{"& .form-section-default > div":{display:"flex",flexWrap:"wrap"},"& .input-description":{width:"100%",...X(e)},"& .input-spotlightImageId, & .input-darkImageId, & .input-spotlightSplashImageUrl":{width:"50%"},"& .input-documentId, & .input-documentType, & .input-position, & .input-draft, & .input-duration, & .input-customTitle, & .input-customSubtitle, & .input-draft, & .input-imageFade, & .input-headerTitle, & .input-headerTitleLeftColor, & .input-headerTitleRightColor, & .input-showAuthor, & .input-subtitleUrl":{width:"calc(25% - 12px)",overflow:"hidden",marginRight:12},"& .input-lastPromotedAt":{width:"calc(25% - 12px)",marginRight:12},"& .form-submit":{display:"flex",justifyContent:"flex-end"}}}})});var C=e.i(182584),B=e.i(995669),F=e.i(280059),N=e.i(935132),T=e.i(244389),A=e.i(79732),D=e.i(429329),R=e.i(946271),E=e.i(824083);let L=(0,D.defineStyles)("SpotlightStartOrContinueReading",e=>({root:{...e.isFriendlyUI&&{[e.breakpoints.down("xs")]:{marginTop:8}},marginTop:4*!e.isFriendlyUI,minHeight:20},placeholder:{},boxesRoot:{},firstPost:{...e.typography.body2,fontSize:e.isFriendlyUI?13:"1.1rem",...e.typography.commentStyle,position:"relative",zIndex:e.zIndexes.spotlightItemCloseButton,color:e.palette.grey[500],"& a":{color:e.palette.primary.main}},postProgressBox:{...(0,F.postProgressBoxStyles)(e),...e.isFriendlyUI&&{borderColor:e.palette.text.alwaysWhite}},read:e.isFriendlyUI?{backgroundColor:e.palette.text.alwaysWhite,border:e.palette.text.alwaysWhite}:{backgroundColor:e.palette.primary.main,border:e.palette.primary.dark,opacity:.4}}),{stylePriority:-2}),W=(0,x.gql)("\n  query SpotlightStartOrContinueReadingQuery($spotlightId: String) {\n    spotlight(input: {selector: {documentId: $spotlightId}}) {\n      result {\n        _id\n        sequenceChapters {\n          _id\n          posts {\n            ...PostsList\n          }\n        }\n      }\n    }\n  }\n"),U=e=>{var i,a,s;let{spotlight:n}=e,{postsRead:o}=(0,B.useItemsRead)(),{data:l}=(0,R.useSuspenseQuery)(W,{variables:{spotlightId:n._id}});if("Sequence"!==n.documentType)return null;let r=null==l||null==(a=l.spotlight)||null==(i=a.result)?void 0:i.sequenceChapters;if(!r)return null;let d=null!=(s=null==r?void 0:r.flatMap(e=>{var t;return null!=(t=e.posts)?t:[]}))?s:[],u=0===d.filter(e=>e.isRead||o[e._id]).length&&d[0];return d.length?u?(0,t.jsx)(_,{spotlight:n,firstPost:u}):(0,t.jsx)(P,{spotlight:n,posts:d}):null},_=e=>{let{spotlight:i,firstPost:a}=e,s=(0,A.useStyles)(L),n=i.documentId,o=(0,N.forumSelect)({EAForum:(0,h.preferredHeadingCase)("Start with: "),default:(0,h.preferredHeadingCase)("First Post: ")});return(0,t.jsxs)("div",{className:(0,r.default)(s.firstPost,s.root),children:[o,(0,t.jsx)(T.default,{post:a,children:(0,t.jsx)(u.Link,{to:(0,C.postGetPageUrl)(a,!1,n),children:a.title})})]})},P=e=>{let{spotlight:i,posts:a}=e,s=(0,A.useStyles)(L),{postsRead:n}=(0,B.useItemsRead)(),o=i.documentId;return(0,t.jsx)("div",{className:(0,r.default)(s.boxesRoot,s.root),children:a.map(e=>(0,t.jsx)(T.default,{post:e,flip:!1,inlineBlock:!0,children:(0,t.jsx)(u.Link,{to:(0,C.postGetPageUrl)(e,!1,o),children:(0,t.jsx)("div",{className:(0,r.default)(s.postProgressBox,{[s.read]:e.isRead||n[e._id]})})})},"".concat(i._id,"-").concat(e._id)))})},H=e=>{let{spotlight:i}=e,a=(0,A.useStyles)(L);return(0,t.jsx)("div",{className:(0,r.default)(a.root,a.placeholder)})},z=e=>{let{spotlight:i}=e;return(0,t.jsx)(E.SuspenseWrapper,{name:"SpotlightStartOrContinueReading",fallback:(0,t.jsx)(H,{spotlight:i}),children:(0,t.jsx)(U,{spotlight:i})})};var M=e.i(716512),G=e.i(110601),O=e.i(813292),q=e.i(944045),V=e.i(144950),$=e.i(460752),Q=e.i(527919);let Y=(0,e.i(770703).default)(()=>e.A(129715).then(e=>({default:e.SpotlightForm})),{loadableGenerated:{modules:[316720]},ssr:!1}),K=(0,x.gql)("\n  mutation updateSpotlightSpotlightItem($selector: SelectorInput!, $data: UpdateSpotlightDataInput!) {\n    updateSpotlight(selector: $selector, data: $data) {\n      data {\n        ...SpotlightDisplay\n      }\n    }\n  }\n"),J=(0,x.gql)("\n  query SpotlightItem($documentId: String) {\n    spotlight(input: { selector: { documentId: $documentId } }) {\n      result {\n        ...SpotlightEditQueryFragment\n      }\n    }\n  }\n"),X=e=>({...(0,p.postBodyStyles)(e),...e.isBookUI?e.typography.body2:{},lineHeight:"1.65rem","& p":{marginTop:".5em",marginBottom:".5em","&:first-child":{marginTop:0},"style~&":{marginTop:0},"&:last-child":{marginBottom:0}}}),Z=e=>{let t="linear-gradient(to right, ".concat(e.join(","),")");return{mask:t,"-webkit-mask-image":t}},ee=(0,D.defineStyles)("SpotlightItem",e=>({root:{marginBottom:12,boxShadow:e.palette.boxShadow.default,maxWidth:g.SECTION_WIDTH,marginLeft:"auto",marginRight:"auto",[e.breakpoints.up("md")]:{width:g.SECTION_WIDTH}},spotlightItem:{position:"relative",borderRadius:e.borderRadius.default,"&:hover":{boxShadow:e.palette.boxShadow.sequencesGridItemHover},"&:hover $adminButtonIcon":{opacity:.2},"&:hover $closeButton":{...e.isFriendlyUI?{color:e.palette.grey[100],background:e.palette.panelBackground.default}:{color:"dark"===e.palette.type?"rgba(0,0,0,.7)":e.palette.grey[400],background:"dark"===e.palette.type?"white":e.palette.panelBackground.default}}},contentContainer:{position:"relative",background:e.palette.panelBackground.default},spotlightFadeBackground:{background:"var(--spotlight-fade)"},closeButtonWrapper:{position:"absolute",top:0,right:0},closeButton:{padding:".5em",minHeight:".75em",minWidth:".75em",color:e.isFriendlyUI?e.palette.text.alwaysWhite:e.palette.grey[300],zIndex:e.zIndexes.spotlightItemCloseButton},hideButton:{cursor:"pointer",position:"absolute",top:12,right:12,width:20,height:20,color:e.palette.text.alwaysWhite,"&:hover":{opacity:.8}},content:{padding:16,paddingRight:35,display:"flex",flexDirection:"column",justifyContent:"space-between",marginRight:150,position:"relative",zIndex:e.zIndexes.spotlightItem,textShadow:e.isFriendlyUI?void 0:"\n      0px 0px 10px ".concat(e.palette.background.default,",\n      0px 0px 20px ").concat(e.palette.background.default,"\n    "),[e.breakpoints.up("sm")]:{minHeight:100},[e.breakpoints.down("xs")]:{marginRight:50},"& br":{[e.breakpoints.down("sm")]:{display:"none"}}},postPadding:{paddingBottom:12},description:{marginTop:7,marginBottom:10,...X(e),position:"relative",[e.breakpoints.down("xs")]:{display:"none"},...e.isFriendlyUI?{fontSize:13,fontWeight:500,fontFamily:e.palette.fonts.sansSerifStack,color:e.palette.text.alwaysWhite,marginTop:8,maxWidth:350,"& a":{color:e.palette.text.alwaysWhite,textDecoration:"underline","&:hover":{opacity:.8,color:"".concat(e.palette.text.alwaysWhite," !important")},"&:visited":{color:e.palette.text.alwaysWhite}}}:{}},title:{...e.typography.postStyle,...e.isFriendlyUI?{fontSize:22,fontWeight:700,color:e.palette.text.alwaysWhite}:{fontSize:20,fontVariant:"small-caps",lineHeight:"1.2em"},display:"flex",alignItems:"center"},subtitle:{...e.typography.postStyle,...e.typography.italic,...e.isFriendlyUI?{fontSize:13,fontWeight:500,fontFamily:e.palette.fonts.sansSerifStack,color:e.palette.text.alwaysWhite,marginTop:8,maxWidth:350}:{minHeight:25,color:e.palette.grey[700],fontSize:15,marginTop:-1}},image:{height:"100%",position:"absolute",top:0,right:0,...e.isFriendlyUI?{borderRadius:e.borderRadius.default,width:"100%",objectFit:"cover"}:{borderTopRightRadius:e.borderRadius.default,borderBottomRightRadius:e.borderRadius.default}},imageFade:Z(["transparent 0","".concat(e.palette.text.alwaysWhite," 80%"),"".concat(e.palette.text.alwaysWhite," 100%")]),imageFadeCustom:Z(["transparent 0","transparent 30%","".concat(e.palette.text.alwaysWhite," 90%"),"".concat(e.palette.text.alwaysWhite," 100%")]),author:{marginTop:4,color:e.palette.grey[600]},authorName:{color:e.palette.primary.main},editAllButton:{[e.breakpoints.up("md")]:{position:"absolute",top:6,right:-28},[e.breakpoints.down("sm")]:{position:"absolute",top:4,right:8}},draftButton:{[e.breakpoints.up("md")]:{position:"absolute",top:35,right:-28},[e.breakpoints.down("sm")]:{position:"absolute",top:33,right:8}},deleteButton:{[e.breakpoints.up("md")]:{position:"absolute",bottom:0,right:-28},[e.breakpoints.down("sm")]:{position:"absolute",bottom:0,right:8}},editAllButtonIcon:{width:20},adminButtonIcon:{width:18,opacity:0,cursor:"pointer",zIndex:e.zIndexes.spotlightItemCloseButton,[e.breakpoints.down("sm")]:{color:e.palette.background.pageActiveAreaBackground,width:16,opacity:.2},"&:hover":{opacity:.5}},editDescriptionButton:{marginLeft:8},editDescription:{"& .form-input":{margin:0},"& .EditorFormComponent-commentEditorHeight":{minHeight:"unset"},"& .EditorFormComponent-commentEditorHeight .ck.ck-content":{minHeight:"unset"},"& .ck.ck-content.ck-editor__editable":{...X(e)},"& .EditorFormComponent-ckEditorStyles .ck.ck-content":{marginLeft:0},"& .ck.ck-editor__editable_inline":{padding:0,border:"none !important"},"& .form-submit button":{position:"absolute",bottom:-38,right:0,marginLeft:12}},form:{borderTop:e.palette.border.faint,background:e.palette.background.translucentBackground,paddingLeft:16,paddingRight:16,paddingTop:8,paddingBottom:8},metaData:{textAlign:"right",paddingTop:6,paddingBottom:12},splashImage:{transform:"translateX(13%) scale(1.15)",filter:"brightness(1.2)"},splashImageContainer:{position:"absolute",top:0,right:0,width:"100%",height:"100%",overflow:"hidden",[e.breakpoints.down("xs")]:{height:"100% !important"}},reverseIcon:{transform:"rotate(180deg)"},reviews:{width:"100%",maxWidth:g.SECTION_WIDTH,borderTop:e.palette.border.extraFaint,background:e.palette.panelBackground.default,[e.breakpoints.down("xs")]:{display:"none"}},review:{"&& .CommentFrame-node":{border:"none",margin:0},"& .SingleLineComment-commentInfo":{paddingLeft:13,backgroundColor:e.palette.background.translucentBackgroundHeavy,borderRadius:0},"& .CommentsItem-root":{borderBottom:e.palette.border.extraFaint,backgroundColor:e.palette.background.pageActiveAreaBackground,"&:last-child":{borderTop:e.palette.border.extraFaint}},"& .comments-node-root":{backgroundColor:"unset"}}}),{stylePriority:-1});function et(e){let{customTitle:t,post:i,sequence:a,tag:s}=e;return t||(i?i.title:a?a.title:s?s.name:"")}let ei=e=>{var p,g,C,B,F,N,T;let{spotlight:D,showAdminInfo:L,hideBanner:W,showSubtitle:U=!0,refetchAllSpotlights:_,isDraftProcessing:P,className:H,children:V}=e,$=(0,A.useStyles)(ee),Q=(0,m.useCurrentUser)(),[X,Z]=(0,s.useState)(!1),[ei,es]=(0,s.useState)(!1),en=(0,b.getSpotlightUrl)(D),eo=D.duration,el=(0,s.useCallback)(()=>{Z(!1),null==_||_()},[_]),{data:er}=(0,R.useQuery)(J,{variables:{documentId:D._id},skip:!(X||ei)}),ed=null==er||null==(p=er.spotlight)?void 0:p.result,[eu]=(0,f.useMutation)(K),{publishAndDeDuplicateSpotlight:ec}=(()=>{let[e]=(0,f.useMutation)((0,x.gql)("\n    mutation publishAndDeDuplicateSpotlight($spotlightId: String) {\n      publishAndDeDuplicateSpotlight(spotlightId: $spotlightId) {\n        ...SpotlightDisplay\n      }\n    }\n  "));return{publishAndDeDuplicateSpotlight:async function(t){return await e({variables:t})}}})(),ep=(0,s.useCallback)(async()=>{Q&&(0,c.userCanDo)(Q,"spotlights.edit.all")&&(D.draft?await ec({spotlightId:D._id}):await eu({variables:{selector:{_id:D._id},data:{draft:!D.draft}}}),null==_||_())},[Q,D._id,D.draft,eu,ec,_]),em=async()=>{P&&D.draft&&(await ec({spotlightId:D._id}),null==_||_())},eh=(0,s.useCallback)(async()=>{Q&&(0,c.userCanDo)(Q,"spotlights.edit.all")&&(await eu({variables:{selector:{_id:D._id},data:{deletedDraft:!0}}}),null==_||_())},[Q,D._id,_,eu]),eg={"--spotlight-fade":D.imageFadeColor},eb=D.subtitleUrl?(0,t.jsx)(u.Link,{to:D.subtitleUrl,children:D.customSubtitle}):D.customSubtitle,ef=null!=(F=null!=(B=D.post)?B:D.sequence)?F:D.tag,ex=function(e){if(e.post){var t;return null!=(t=e.post.reviews)?t:[]}return[]}(D);return(0,t.jsx)(y.AnalyticsContext,{pageElementContext:"spotlightItem",children:(0,t.jsx)(S.default,{eventType:"spotlightItem",captureOnMount:!0,captureOnClick:!1,children:(0,t.jsxs)("div",{id:D._id,style:eg,className:(0,r.default)($.root,H),children:[(0,t.jsxs)("div",{className:(0,r.default)($.spotlightItem,{[$.spotlightFadeBackground]:!!D.imageFadeColor}),children:[(0,t.jsxs)("div",{className:$.contentContainer,children:[(0,t.jsxs)("div",{className:(0,r.default)($.content,{[$.postPadding]:"Post"===D.documentType}),children:[(0,t.jsxs)("div",{className:$.title,children:[(0,t.jsx)(u.Link,{to:en,children:et(D)}),(0,t.jsx)("span",{className:$.editDescriptionButton,children:L&&(0,c.userCanDo)(Q,"spotlights.edit.all")&&(0,t.jsx)(G.default,{title:"Edit Spotlight",children:(0,t.jsx)(a.default,{className:$.adminButtonIcon,onClick:()=>es(!ei)})})})]}),D.customSubtitle&&U&&(0,t.jsx)("div",{className:$.subtitle,children:eb}),((null==(g=D.description)?void 0:g.html)||(0,h.isBookUI)())&&(0,t.jsx)("div",{className:$.description,children:ei&&ed?(0,t.jsx)("div",{className:$.editDescription,children:(0,t.jsx)(Y,{initialData:(0,q.withDateFields)(ed,["lastPromotedAt"]),descriptionOnly:!0,onSuccess:()=>{es(!1),em()}})}):(0,t.jsx)(I.ContentItemBody,{dangerouslySetInnerHTML:{__html:null!=(N=null==(C=D.description)?void 0:C.html)?N:""},description:"".concat(D.documentType," ").concat(null==ef?void 0:ef._id)})}),D.showAuthor&&(null==ef?void 0:ef.user)&&(0,t.jsxs)(M.Typography,{variant:"body2",className:$.author,children:["by ",(0,t.jsx)(u.Link,{className:$.authorName,to:(0,d.userGetProfileUrlFromSlug)(null==ef?void 0:ef.user.slug),children:null==ef?void 0:ef.user.displayName})]}),"Sequence"===D.documentType&&(0,t.jsx)(E.SuspenseWrapper,{name:"SpotlightStartOrContinueReading",children:(0,t.jsx)(z,{spotlight:D})})]}),D.spotlightSplashImageUrl&&(0,t.jsx)("div",{className:$.splashImageContainer,style:{height:"calc(100% + ".concat((null!=(T=ex.length)?T:0)*30,"px)")},children:(0,t.jsx)("img",{src:D.spotlightSplashImageUrl,className:(0,r.default)($.image,$.imageFade,$.splashImage)})}),D.spotlightImageId&&(0,t.jsx)(k.default,{publicId:D.spotlightImageId,darkPublicId:D.spotlightDarkImageId,className:(0,r.default)($.image,{[$.imageFade]:D.imageFade&&!D.imageFadeColor,[$.imageFadeCustom]:D.imageFade&&D.imageFadeColor}),imgProps:{w:"500"},loading:"lazy"})]}),ex.length>0&&(0,t.jsx)(ea,{reviewIds:ex.map(e=>e._id)}),W&&((0,h.isFriendlyUI)()?(0,t.jsx)(O.default,{icon:"Close",onClick:W,className:$.hideButton}):(0,t.jsx)("div",{className:$.closeButtonWrapper,children:(0,t.jsx)(G.default,{title:"Hide this spotlight",placement:"right",children:(0,t.jsx)(i.default,{className:$.closeButton,onClick:W,children:(0,t.jsx)(O.default,{icon:"Close"})})})})),(0,t.jsx)("div",{className:$.editAllButton,children:(0,c.userCanDo)(Q,"spotlights.edit.all")&&(0,t.jsx)(G.default,{title:"Edit Spotlight",children:(0,t.jsx)(o.default,{className:(0,r.default)($.adminButtonIcon,$.editAllButtonIcon),onClick:()=>Z(!X)})})}),(0,t.jsx)("div",{className:$.draftButton,children:L&&(0,c.userCanDo)(Q,"spotlights.edit.all")&&(0,t.jsx)(G.default,{title:D.draft?"Undraft, and archive duplicates":"Draft",children:(0,t.jsx)(n,{className:(0,r.default)($.adminButtonIcon,$.editAllButtonIcon,!D.draft&&$.reverseIcon),onClick:()=>ep()})})}),D.draft&&(0,t.jsx)("div",{className:$.deleteButton,children:L&&(0,c.userCanDo)(Q,"spotlights.edit.all")&&(0,t.jsx)(G.default,{title:"Archive",children:(0,t.jsx)(l.default,{className:(0,r.default)($.adminButtonIcon,$.editAllButtonIcon),onClick:()=>eh()})})})]}),X&&ed&&(0,t.jsx)("div",{className:$.form,children:(0,t.jsx)(w,{children:(0,t.jsx)(Y,{initialData:(0,q.withDateFields)(ed,["lastPromotedAt"]),onSuccess:el})})}),!X&&L&&(0,t.jsxs)("div",{className:$.metaData,children:[D.draft&&(0,t.jsx)(v.default,{children:"[Draft]"}),(0,t.jsx)(v.default,{children:D.position}),(0,t.jsx)(v.default,{children:(0,t.jsx)(j.default,{date:D.lastPromotedAt,format:"YYYY-MM-DD"})}),(0,t.jsx)(G.default,{title:"This will be on the frontpage for ".concat(eo," days when it rotates in"),children:(0,t.jsxs)(v.default,{children:[eo," days"]})})]})]})})})},ea=e=>{let{reviewIds:i}=e,a=(0,A.useStyles)(ee);return(0,t.jsx)("div",{className:a.reviews,children:(0,t.jsx)(E.SuspenseWrapper,{name:"SpotlightReviews",fallback:(0,t.jsx)(es,{numReviews:i.length}),children:i.map(e=>(0,t.jsx)(en,{id:e},e))})})},es=e=>{let{numReviews:i}=e,a=(0,A.useStyles)(ee);return(0,t.jsx)("div",{className:a.review,children:(0,V.default)(i).map(e=>(0,t.jsx)(Q.SingleLineCommentPlaceholder,{nestingLevel:1},e))})},en=e=>{let{id:i}=e,a=(0,A.useStyles)(ee);return(0,t.jsx)("div",{className:a.review,children:(0,t.jsx)($.CommentByIdSuspense,{commentId:i,treeOptions:{singleLineCollapse:!0,forceSingleLine:!0,hideSingleLineMeta:!0},nestingLevel:1,loadChildren:!1})})}},602534,e=>{"use strict";var t=e.i(843476),i=e.i(538794),a=e.i(159211),s=e.i(343794),n=e.i(946271);e.i(813868);let o=(0,e.i(122756).gql)("\n  query PostsGroupDetails($documentId: String) {\n    localgroup(input: { selector: { documentId: $documentId } }) {\n      result {\n        ...localGroupsHomeFragment\n      }\n    }\n  }\n"),l=(0,i.registerComponent)("PostsGroupDetails",e=>{var i;let l,{documentId:r,post:d,inRecentDiscussion:u,classes:c}=e,{data:p}=(0,n.useQuery)(o,{variables:{documentId:r}}),m=null==p||null==(i=p.localgroup)?void 0:i.result;return m?(d.group&&(l=m.deleted?m.name:(0,t.jsx)(a.Link,{to:"/groups/"+d.group._id,children:m.name})),(0,t.jsx)("div",{className:u?"":c.root,children:(0,t.jsx)("div",{className:(0,s.default)(c.title,{[c.recentDiscussionTitle]:u,[c.notRecentDiscussionTitle]:!u}),children:l})})):null},{styles:e=>({title:{display:"inline-block",fontSize:22,verticalAlign:"-webkit-baseline-middle",lineHeight:"24px",color:e.palette.text.dim,marginTop:-10,...e.typography.smallCaps},notRecentDiscussionTitle:{fontFamily:e.isFriendlyUI?e.palette.fonts.sansSerifStack:e.typography.body1.fontFamily},recentDiscussionTitle:{fontSize:16,fontFamily:e.typography.fontFamily},root:{marginBottom:e.isFriendlyUI?5:12,marginTop:10}})});e.s(["default",0,l])},139267,e=>{"use strict";var t=e.i(843476),i=e.i(538794),a=e.i(271645),s=e.i(161517);let n=(0,i.registerComponent)("AnalyticsInViewTracker",e=>{let{eventType:i,eventProps:n,observerProps:o,children:l,skip:r}=e,{setNode:d,entry:u}=(0,s.useIsInView)(o),c=(0,a.useCallback)((0,s.useTracking)({eventType:i||"inViewEvent",eventProps:{...n,...o}}).captureEvent,[]);return(0,a.useEffect)(()=>{if(!r&&u){let{time:e,isIntersecting:t,intersectionRatio:i}=u;c(void 0,{time:e,isIntersecting:t,intersectionRatio:i})}},[u,c,r]),(0,t.jsx)("span",{ref:d,children:l})});e.s(["default",0,n])},537992,e=>{"use strict";var t=e.i(843476),i=e.i(271645);let a=(0,e.i(339213).default)((0,t.jsxs)(i.default.Fragment,{children:[(0,t.jsx)("path",{fill:"none",d:"M0 0h24v24H0z"}),(0,t.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z"})]}),"MailOutline");e.s(["default",0,a])},232112,e=>{"use strict";function t(e){if(e){if(e.id)return e.id;else if(e.message)try{let i=JSON.parse(e.message);return t(i)}catch(e){}}return null}function i(e){return t(e)||"Error"}function a(e){return e&&"app.missing_document"===e.message}function s(e){return e&&"app.operation_not_allowed"===e.message}e.s(["getGraphQLErrorID",()=>t,"getGraphQLErrorMessage",()=>i,"isMissingDocumentError",()=>a,"isOperationNotAllowedError",()=>s])},61530,e=>{"use strict";var t=e.i(843476),i=e.i(271645),a=e.i(538794),s=e.i(530841),n=e.i(84377),o=e.i(820010),l=e.i(144437),r=e.i(232112),d=e.i(2942),u=e.i(448621);e.i(793794);var c=e.i(527633);e.i(248944);var p=e.i(921104),m=e.i(537992);let h=(0,e.i(339213).default)((0,t.jsxs)(i.default.Fragment,{children:[(0,t.jsx)("path",{fill:"none",d:"M0 0h24v24H0V0z"}),(0,t.jsx)("path",{d:"M9 16.17L5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L9 16.17z"})]}),"CheckRounded");var g=e.i(96009),b=e.i(161517),f=e.i(552275),x=e.i(935132);e.i(725105);var y=e.i(572148),v=e.i(912087),j=e.i(437059),S=e.i(239832),I=e.i(139267);let k="https://effectivealtruism.us8.list-manage.com/subscribe/post?u=52b028e7f799cca137ef74763&amp;id=7457c7ff3e&amp;f_id=0086c5e1f0",w=(0,a.registerComponent)("RecentDiscussionSubscribeReminder",e=>{let a,{classes:g}=e,w=(0,s.useCurrentUser)(),C=(0,n.useUpdateCurrentUser)(),[B,F]=(0,i.useState)(!1),[N,T]=(0,i.useState)(!0),[A,D]=(0,i.useState)(!1),[R,E]=(0,i.useState)(!1),L=(0,i.useRef)(null),[W,U]=(0,i.useState)(!1),{flash:_}=(0,l.useMessages)(),P="(2-3 posts per week, selected by the LessWrong moderation team.)",{captureEvent:H}=(0,b.useTracking)({eventProps:{pageElementContext:"subscribeReminder"}}),[z,M]=(0,i.useState)(-1),G=(null==w?void 0:w.isAdmin)?(0,t.jsx)("div",{className:g.adminNotice,children:"You are seeing this UI element because you're an admin. Admins are shown a random version of the subscribe-reminder even if they're already subscribed, to make sure it still works and isn't annoying."}):null;if((0,i.useEffect)(()=>{-1===z&&(null==w?void 0:w.isAdmin)&&M((0,d.randInt)((0,x.isLWorAF)()?5:4))},[z,null==w?void 0:w.isAdmin]),(0,x.isAF)())return null;if(-1===z&&(null==w?void 0:w.isAdmin))return(0,t.jsx)("div",{});a=(0,x.isLW)()?null==w?void 0:w.emailSubscribedToCurated:null==w?void 0:w.subscribedToDigest;let O=(0,t.jsx)(c.default,{className:g.maybeLaterButton,onClick:()=>{F(!0),H("subscribeReminderButtonClicked",{buttonType:"maybeLaterButton"})},children:"Maybe Later"}),q=(0,t.jsx)("span",{children:w&&(0,t.jsx)(c.default,{className:g.dontAskAgainButton,onClick:()=>{C({hideSubscribePoke:!0}),F(!0),H("subscribeReminderButtonClicked",{buttonType:"dontAskAgainButton"})},children:"Don't Ask Again"})});if(B||(null==w?void 0:w.hideSubscribePoke))return null;let V=async()=>{U(!0);let e=(0,x.isLW)()?{emailSubscribedToCurated:!0}:{subscribedToDigest:!0};e.unsubscribeFromAll=!1,(0,o.userEmailAddressIsVerified)(w)||(e.whenConfirmationEmailSent=new Date);try{await C(e),E(!0)}catch(e){_((0,r.getGraphQLErrorMessage)(e))}U(!1)},$=e=>{let{children:i,branch:a}=e;return(0,t.jsx)(b.AnalyticsContext,{pageElementContext:"subscribeReminder",branch:a,children:(0,t.jsx)(I.default,{eventProps:{inViewType:"subscribeReminder"},children:(0,t.jsx)("div",{className:g.root,children:i})})})},Q=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:g.message,children:[(0,t.jsx)(m.default,{className:g.mailIcon}),"Sign up for the Forum's email digest"]}),(0,t.jsx)("div",{className:g.messageDescription,children:"You'll get a weekly email with the best posts from the past week. The Forum team selects the posts to feature based on personal preference and Forum popularity, and also adds some announcements and a classic post."})]});if(W)return(0,t.jsx)("div",{className:g.root,children:(0,t.jsx)(S.default,{})});if(R){let e;return e=(0,x.isLW)()?"You are subscribed to the best posts of LessWrong!":"You are subscribed to the ".concat(f.forumTitleSetting," Digest"),(0,t.jsx)($,{branch:"already-subscribed",children:(0,t.jsxs)("div",{className:g.message,children:[(0,t.jsx)(h,{className:g.checkIcon}),e]})})}if(A){let e=w&&(0,o.getUserEmail)(w);return(0,t.jsx)($,{branch:"needs-email-verification-subscribed-in-other-branch",children:(0,t.jsxs)("div",{className:g.message,children:["We sent an email to ",e,". Follow the link in the email to complete your subscription."]})})}if(w&&0!==z)if((0,o.userHasEmailAddress)(w)&&1!==z)if(w.unsubscribeFromAll||2===z){let e=(0,x.isEAForum)()?Q:(0,t.jsxs)("div",{className:g.message,children:["You previously unsubscribed from all emails from LessWrong. Re-subscribe to get the best posts emailed to you! ",P]});return(0,t.jsxs)($,{branch:"previously-unsubscribed",children:[e,(0,t.jsx)(c.default,{className:g.subscribeButton,onClick:async e=>{await V(),H("subscribeReminderButtonClicked",{buttonType:"subscribeButton"})},children:"Subscribe"}),G,(0,t.jsxs)("div",{className:g.buttons,children:[O,q]})]})}else if(a&&3!==z)if(!(0,o.userEmailAddressIsVerified)(w)||4===z)return(0,t.jsx)($,{branch:"needs-email-verification",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:g.message,children:"Please verify your email address to activate your subscription to curated posts."}),(0,t.jsxs)("div",{className:g.buttons,children:[(0,t.jsx)(c.default,{className:g.subscribeButton,onClick:async e=>{U(!0);try{await C({whenConfirmationEmailSent:new Date})}catch(e){_((0,r.getGraphQLErrorMessage)(e))}U(!1),D(!0),H("subscribeReminderButtonClicked",{buttonType:"resendVerificationEmailButton"})},children:"Resend Verification Email"}),G,(0,t.jsxs)("div",{className:g.buttons,children:[O,q]})]})]})});else return null;else{let e=(0,x.isEAForum)()?Q:(0,t.jsxs)("div",{className:g.message,children:["Subscribe to get the best of LessWrong emailed to you. ",P]});return(0,t.jsxs)($,{branch:"logged-in-not-subscribed",children:[e,(0,t.jsx)(c.default,{className:g.subscribeButton,onClick:async e=>{await V(),H("subscribeReminderButtonClicked",{buttonType:"subscribeButton"})},children:"Subscribe"}),G,(0,t.jsxs)("div",{className:g.buttons,children:[O,q]})]})}else{let e=(0,x.isEAForum)()?"our weekly digest email":"curated posts";return(0,t.jsxs)($,{branch:"missing-email",children:[(0,t.jsxs)("div",{className:g.message,children:["Your account does not have an email address associated. Add an email address to subscribe to ",e," and enable notifications."]}),(0,t.jsx)(p.default,{placeholder:"Email address",inputRef:L,className:g.emailInput}),(0,t.jsx)(j.default,{defaultValue:!0,onChange:e=>T(!0)}),(0,t.jsxs)("div",{className:g.buttons,children:[(0,t.jsx)(c.default,{className:g.subscribeButton,onClick:async e=>{let t=L.current;if(t&&u.default.RegEx.Email.test(null==t?void 0:t.value)){U(!0);try{let e=(0,x.isEAForum)()?{subscribedToDigest:N}:{emailSubscribedToCurated:N};e.email=null==t?void 0:t.value,e.unsubscribeFromAll=!1,await C(e),(0,o.userEmailAddressIsVerified)(w)||await C({whenConfirmationEmailSent:new Date}),E(!0)}catch(e){"users.email_already_taken"===(0,r.getGraphQLErrorID)(e)?_("That email address is already taken by a different account."):_(e.message||e.id)}U(!1)}else _("Please enter a valid email address.");H("subscribeReminderButtonClicked",{buttonType:"subscribeButton"})},children:"Submit"}),G,(0,t.jsxs)("div",{className:g.buttons,children:[O,q]})]})]})}{let e=(0,x.isEAForum)()?Q:(0,t.jsxs)("div",{className:g.message,children:["To get the best posts emailed to you, create an account! ",P]});return(0,t.jsxs)($,{branch:"logged-out",children:[e,(0,x.isEAForum)()?(0,t.jsxs)("form",{action:k,method:"post",className:g.digestForm,children:[(0,t.jsx)(y.default,{label:"Email address",name:"EMAIL",required:!0,className:g.digestFormInput}),(0,t.jsx)(c.default,{variant:"contained",type:"submit",color:"primary",className:g.digestFormSubmitBtn,children:"Sign up"})]}):(0,t.jsx)("div",{className:g.loginForm,children:(0,t.jsx)(v.default,{startingState:"signup"})}),G]})}},{styles:e=>({root:{marginBottom:4*e.spacing.unit,position:"relative",backgroundColor:e.isFriendlyUI?e.palette.grey[0]:e.palette.panelBackground.recentDiscussionThread,border:e.isFriendlyUI?"1px solid ".concat(e.palette.grey[200]):void 0,padding:16,...e.typography.body2,boxShadow:e.palette.boxShadow.default,borderRadius:e.borderRadius.default,marginLeft:"auto",marginRight:"auto",maxWidth:500},adminNotice:{textAlign:"left",marginTop:22,fontSize:12,lineHeight:1.3,fontStyle:"italic"},loginForm:{margin:"0 auto -4px",maxWidth:252},digestForm:{display:"flex",flexWrap:"wrap",alignItems:"baseline",columnGap:30,rowGap:"14px",padding:"20px 50px 20px 20px",[e.breakpoints.down("xs")]:{padding:10}},digestFormInput:{flexGrow:1},digestFormSubmitBtn:{minHeight:0,boxShadow:"none"},message:{display:"flex",alignItems:"flex-start",fontSize:18,lineHeight:1.75},messageDescription:{fontSize:12,marginTop:8},mailIcon:{color:e.palette.primary.main,marginTop:4,marginRight:12},checkIcon:{color:e.palette.icon.greenCheckmark,marginTop:4,marginRight:12},emailInput:{marginTop:18},subscribeButton:{margin:"18px auto 0",display:"block",background:e.palette.primary.main,color:e.palette.buttons.recentDiscussionSubscribeButtonText,fontSize:15},buttons:{marginTop:16,textAlign:"right"},maybeLaterButton:{},dontAskAgainButton:{}}),hocs:[g.default]});e.s(["default",0,w,"eaForumDigestSubscribeURL",0,k],61530)}]);

//# debugId=5302ce64-4a41-90f5-720e-307aad4169d9
//# sourceMappingURL=564a0229a248c28e.js.map